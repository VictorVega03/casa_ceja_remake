<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:CasaCejaRemake.ViewModels.POS"
        xmlns:converters="using:CasaCejaRemake.Converters"
        x:Class="CasaCejaRemake.Views.POS.SalesView"
        x:DataType="vm:SalesViewModel"
        Title="Punto de Venta - Casa Ceja"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#1E1E1E">

    <Window.Styles>
        <!-- Estilo para botones de accion -->
        <Style Selector="Button.action-button">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        <Style Selector="Button.action-button:pointerover">
            <Setter Property="Background" Value="#1084D8"/>
        </Style>
        <Style Selector="Button.danger-button">
            <Setter Property="Background" Value="#D32F2F"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        <Style Selector="Button.danger-button:pointerover">
            <Setter Property="Background" Value="#E53935"/>
        </Style>
        <Style Selector="Button.success-button">
            <Setter Property="Background" Value="#388E3C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="20,15"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        <Style Selector="Button.success-button:pointerover">
            <Setter Property="Background" Value="#43A047"/>
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="Auto,*">
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#252525" Padding="15">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.3" BlurRadius="10" OffsetX="0" OffsetY="2"/>
            </Border.Effect>
            <Grid ColumnDefinitions="Auto,*,Auto,*">
                <!-- Botón de Menú Hamburguesa -->
                <Button x:Name="BtnToggleSidebar"
                        Grid.Column="0"
                        Content="☰"
                        FontSize="24"
                        Foreground="White"
                        Background="Transparent"
                        Padding="10,0,20,0"
                        VerticalAlignment="Center"
                        Cursor="Hand"/>

                <!-- Info izquierda -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="30">
                    <StackPanel>
                        <TextBlock Text="FOLIO DE CORTE" FontSize="10" Foreground="#888"/>
                        <TextBlock Text="{Binding CashCloseFolio}" FontSize="16" Foreground="White" FontWeight="Bold"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="COBRANZA" FontSize="10" Foreground="#888"/>
                        <StackPanel Orientation="Horizontal" Spacing="5">
                            <Button x:Name="BtnPrevCollection" 
                                    Background="#444" 
                                    Foreground="White"
                                    Padding="8,5"
                                    VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="5" VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Text="◀" FontSize="14" FontWeight="Bold" Margin="0,-2,0,0"/>
                                    <TextBlock Text="F4" FontSize="12" FontWeight="Bold" Foreground="#DDD"/>
                                </StackPanel>
                            </Button>
                            
                            <TextBlock Text="{Binding CurrentCollection}" FontSize="24" Foreground="#66BB6A" FontWeight="Bold" Margin="0,0,0,2" VerticalAlignment="Center"/>
                            
                            <Button x:Name="BtnNextCollection" 
                                    Background="#444" 
                                    Foreground="White"
                                    Padding="8,5"
                                    VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" Spacing="5" VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Text="F5" FontSize="12" FontWeight="Bold" Foreground="#DDD"/>
                                    <TextBlock Text="▶" FontSize="14" FontWeight="Bold" Margin="0,-2,0,0"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                    <!-- Indicadores de cobranzas con items -->
                    <StackPanel Orientation="Horizontal" Spacing="3" VerticalAlignment="Center">
                        <Button x:Name="BtnCollectionA" Content="A" Width="28" Height="28" FontSize="12" FontWeight="Bold" CornerRadius="4" Padding="0" ToolTip.Tip="Ir a cobranza A"/>
                        <Button x:Name="BtnCollectionB" Content="B" Width="28" Height="28" FontSize="12" FontWeight="Bold" CornerRadius="4" Padding="0" ToolTip.Tip="Ir a cobranza B"/>
                        <Button x:Name="BtnCollectionC" Content="C" Width="28" Height="28" FontSize="12" FontWeight="Bold" CornerRadius="4" Padding="0" ToolTip.Tip="Ir a cobranza C"/>
                        <Button x:Name="BtnCollectionD" Content="D" Width="28" Height="28" FontSize="12" FontWeight="Bold" CornerRadius="4" Padding="0" ToolTip.Tip="Ir a cobranza D"/>
                    </StackPanel>
                </StackPanel>

                <!-- Titulo central -->
                <TextBlock Grid.Column="2" 
                           Text="PUNTO DE VENTA" 
                           FontSize="24" 
                           FontWeight="Bold" 
                           Foreground="#E0E0E0"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>

                <!-- Info derecha -->
                <StackPanel Grid.Column="3" Orientation="Horizontal" Spacing="30" HorizontalAlignment="Right">
                    <StackPanel>
                        <TextBlock Text="SUCURSAL" FontSize="10" Foreground="#888"/>
                        <TextBlock Text="{Binding Branch}" FontSize="14" Foreground="White"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="USUARIO" FontSize="10" Foreground="#888"/>
                        <TextBlock Text="{Binding User}" FontSize="14" Foreground="White"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="FECHA/HORA" FontSize="10" Foreground="#888"/>
                        <TextBlock x:Name="TxtFechaHora" Text="{Binding FechaHora}" FontSize="14" Foreground="White"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Contenido Principal con SplitView -->
        <SplitView x:Name="MainSplitView" 
                   Grid.Row="1"
                   IsPaneOpen="False" 
                   DisplayMode="Overlay" 
                   OpenPaneLength="300" 
                   PanePlacement="Left"
                   PaneBackground="#252525">
            <!-- Menú Lateral (Sidebar) -->
            <SplitView.Pane>
                <Grid RowDefinitions="Auto,*,Auto" Margin="10">
                    <TextBlock Grid.Row="0" Text="MENÚ PRINCIPAL" FontSize="18" FontWeight="Bold" Foreground="White" Margin="10,20,10,20" HorizontalAlignment="Center"/>
                    
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel Spacing="10">
                            <!-- Opciones agrupadas -->
                            <TextBlock Text="SISTEMA" FontSize="12" Foreground="#888" FontWeight="Bold" Margin="10,10,0,5"/>
                            <Button x:Name="BtnCashClose" Classes="action-button" Background="#2196F3" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Click="OnCashCloseClick">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <!-- Cash Register / Savings Icon -->
                                    <Path Fill="White" Width="16" Height="16" Stretch="Uniform" 
                                          Data="M19,14V6c0-1.1-0.9-2-2-2H3C1.9,4,1,4.9,1,6v8c0,1.1,0.9,2,2,2h14C18.1,16,19,15.1,19,14z M17,14H3V6h14V14z M9,7h2v2h-2V7z M13,7h2v2h-2V7z M5,7h2v2H5V7z M9,11h2v2h-2V11z M5,11h2v2H5V11z M13,11h2v2h-2V11z M2,18v2h16v-2H2z" />
                                    <TextBlock Text="Corte de Caja (F10)"/>
                                </StackPanel>
                            </Button>

                            <Button x:Name="BtnPosConfig" Classes="action-button" Background="#333" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Click="OnPosConfigClick">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <Path Fill="White" Width="16" Height="16" Stretch="Uniform" 
                                          Data="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                                    <TextBlock Text="Configuración de Caja"/>
                                </StackPanel>
                            </Button>
                            
                            <Button x:Name="BtnCashiers" Classes="action-button" Background="#333" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Click="OnCashiersClick">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <!-- Person Icon -->
                                    <Path Fill="White" Width="16" Height="16" Stretch="Uniform" 
                                          Data="M12,12c2.21,0,4-1.79,4-4s-1.79-4-4-4S8,5.79,8,8S9.79,12,12,12z M12,14c-2.67,0-8,1.34-8,4v2h16v-2C20,15.34,14.67,14,12,14z"/>
                                    <TextBlock Text="Cajeros"/>
                                </StackPanel>
                            </Button>
                            
                            <Separator Background="#444" Margin="10,5"/>
                            
                            <TextBlock Text="OPERACIONES DE CAJA" FontSize="12" Foreground="#888" FontWeight="Bold" Margin="10,10,0,5"/>
                            <Button x:Name="BtnIncome" Classes="action-button" Background="#4CAF50" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Click="OnIncomeClick">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <!-- Add Icon -->
                                    <Path Fill="White" Width="16" Height="16" Stretch="Uniform" Data="M19,13h-6v6h-2v-6H5v-2h6V5h2v6h6V13z"/>
                                    <TextBlock Text="Ingreso (F7)"/>
                                </StackPanel>
                            </Button>
                            
                            <Button x:Name="BtnExpense" Classes="action-button" Background="#FF9800" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Click="OnExpenseClick">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <!-- Remove/Minus Icon -->
                                    <Path Fill="White" Width="16" Height="16" Stretch="Uniform" Data="M19,13H5v-2h14V13z"/>
                                    <TextBlock Text="Gasto (F6)"/>
                                </StackPanel>
                            </Button>
                            
                            <Separator Background="#444" Margin="10,5"/>
                            
                            <TextBlock Text="REPORTES" FontSize="12" Foreground="#888" FontWeight="Bold" Margin="10,10,0,5"/>
                            <Button x:Name="BtnSalesHistory" Classes="action-button" Background="#333" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Click="OnSalesHistoryClick">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <!-- Receipt Icon -->
                                    <Path Fill="White" Width="16" Height="16" Stretch="Uniform" 
                                          Data="M18,17H6v-2h12V17z M18,13H6v-2h12V13z M18,9H6V7h12V9z M3,22l1.5-1.5L6,22l1.5-1.5L9,22l1.5-1.5L12,22l1.5-1.5L15,22l1.5-1.5 L18,22l1.5-1.5L21,22V2l-1.5,1.5L18,2l-1.5,1.5L15,2l-1.5,1.5L12,2l-1.5,1.5L9,2L7.5,3.5L6,2L4.5,3.5L3,2V22z"/>
                                    <TextBlock Text="Historial de Ventas"/>
                                </StackPanel>
                            </Button>
                            
                            <Button x:Name="BtnCashCloseHistory" Classes="action-button" Background="#333" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Click="OnCashCloseHistoryClick">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <!-- Leaderboard/History Chart Icon -->
                                    <Path Fill="White" Width="16" Height="16" Stretch="Uniform" 
                                          Data="M19,3H5C3.9,3,3,3.9,3,5v14c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V5C21,3.9,20.1,3,19,3z M9,17H7v-7h2V17z M13,17h-2v-3h2V17z M13,12h-2V7h2V12z M17,17h-2v-5h2V17z"/>
                                    <TextBlock Text="Historial de Cortes (F9)"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Opciones de Salida -->
                    <StackPanel Grid.Row="2" Spacing="10" Margin="0,20,0,10">
                        <Button Command="{Binding LogoutCommand}" Classes="action-button" Background="#607D8B" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center">
                            <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
                                <!-- Logout Door SVG -->
                                <Path Fill="White" Width="18" Height="18" Stretch="Uniform" 
                                      Data="M10.09,15.59L11.5,17l5-5l-5-5l-1.41,1.41L12.67,11H3v2h9.67L10.09,15.59z M19,3H5C3.89,3,3,3.9,3,5v4h2V5h14v14H5v-4H3v4 c0,1.1,0.89,2,2,2h14c1.1,0,2-0.9,2-2V5C21,3.9,20.1,3,19,3z"/>
                                <TextBlock Text="Cerrar Sesión"/>
                            </StackPanel>
                        </Button>
                        <Button Command="{Binding ExitCommand}" Classes="danger-button" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center">
                            <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
                                <!-- Home SVG -->
                                <Path Fill="White" Width="18" Height="18" Stretch="Uniform" 
                                      Data="M10,20v-6h4v6h5v-8h3L12,3L1,12h3v8H10z"/>
                                <TextBlock Text="Salir al Menú"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Grid>
            </SplitView.Pane>

            <!-- Área de Ventas (Contenido central) -->
            <SplitView.Content>
                <Grid RowDefinitions="*,Auto,Auto">

                    <!-- Area principal -->
                    <Grid Grid.Row="0" ColumnDefinitions="*,300" Margin="10">
            
            <!-- Contenido principal interactivo -->
            <Grid Grid.Column="0" RowDefinitions="Auto,*" Margin="0,0,10,0">
                
                <!-- Fila superior: Input de código y botones de acción (50% / 50%) -->
                <Grid Grid.Row="0" ColumnDefinitions="*,*" Margin="0,0,0,10">
                    
                    <!-- Mitad izquierda: Input de codigo de barras -->
                    <Border Grid.Column="0" Background="#2D2D2D" Padding="15" CornerRadius="4" Margin="0,0,5,0">
                        <Grid ColumnDefinitions="Auto,*,Auto">
                            <TextBlock Grid.Column="0" 
                                       Text="CODIGO:" 
                                       VerticalAlignment="Center" 
                                       Foreground="White"
                                       FontSize="16"
                                       Margin="0,0,10,0"/>
                            <TextBox x:Name="TxtBarcode"
                                     Grid.Column="1"
                                     Text="{Binding Barcode, Mode=TwoWay}"
                                     FontSize="18"
                                     Padding="10"
                                     Background="#3D3D3D"
                                     Foreground="White"
                                     BorderThickness="0"
                                     CornerRadius="4"/>
                            <TextBlock Grid.Column="2"
                                       Text="F1"
                                       VerticalAlignment="Center"
                                       Foreground="#888"
                                       FontSize="12"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </Border>
                    
                    <!-- Mitad derecha: Botones de acción rápida que antes estaban abajo -->
                    <Border Grid.Column="1" Background="#2D2D2D" Padding="10" CornerRadius="4" Margin="5,0,0,0">
                        <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right" VerticalAlignment="Center">
                            <Button Classes="action-button" Command="{Binding SearchProductCommand}" Height="45" Padding="15,5">
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                    <!-- Catalog/List Icon -->
                                    <Path Fill="White" Width="18" Height="18" Stretch="Uniform" 
                                          Data="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"/>
                                    <TextBlock Text="Catálogo (F3)" VerticalAlignment="Center" FontWeight="Bold"/>
                                </StackPanel>
                            </Button>
                            
                            <Button Classes="action-button" Command="{Binding ModifyQuantityCommand}" Height="45" Padding="15,5">
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                    <Path Fill="White" Width="18" Height="18" Stretch="Uniform" 
                                          Data="M3,17.25V21h3.75L17.81,9.94l-3.75-3.75L3,17.25z M20.71,7.04c0.39-0.39,0.39-1.02,0-1.41l-2.34-2.34c-0.39-0.39-1.02-0.39-1.41,0l-1.83,1.83l3.75,3.75L20.71,7.04z"/>
                                    <TextBlock Text="Cantidad (F2)" VerticalAlignment="Center" FontWeight="Bold"/>
                                </StackPanel>
                            </Button>
                            
                            <Button Classes="danger-button" Command="{Binding RemoveProductCommand}" Height="45" Padding="15,5">
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                    <Path Fill="White" Width="18" Height="18" Stretch="Uniform" 
                                          Data="M16,9v10H8V9H16 M15.5,4l-1-1h-5l-1,1H5v2h14V4H15.5z M18,7H6v12c0,1.1,0.9,2,2,2h8c1.1,0,2-0.9,2-2V7z"/>
                                    <TextBlock Text="Eliminar (Supr)" VerticalAlignment="Center" FontWeight="Bold"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- DataGrid de productos -->
                <Border Grid.Row="1" Background="#2D2D2D" Padding="10" CornerRadius="4">
                    <DataGrid x:Name="GridProducts"
                              ItemsSource="{Binding Items}"
                              SelectedIndex="{Binding SelectedItemIndex, Mode=TwoWay}"
                              SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              Background="#2D2D2D"
                              BorderThickness="0">
                        <DataGrid.RowBackground>
                            <SolidColorBrush Color="#2D2D2D"/>
                        </DataGrid.RowBackground>
                        <DataGrid.Styles>
                            <!-- Color base para filas normales -->
                            <Style Selector="DataGridRow">
                                <Setter Property="Background" Value="#2D2D2D"/>
                            </Style>
                            <Style Selector="DataGridRow:nth-child(even)">
                                <Setter Property="Background" Value="#353535"/>
                            </Style>
                            <!-- Selector con color sólido que cubre el fondo -->
                            <Style Selector="DataGridRow:pointerover">
                                <Setter Property="Background" Value="#3D3D3D"/>
                            </Style>
                            <Style Selector="DataGridRow:selected">
                                <Setter Property="Background" Value="#0078D4"/>
                            </Style>
                            <Style Selector="DataGridRow:selected:pointerover">
                                <Setter Property="Background" Value="#1084D8"/>
                            </Style>
                            <Style Selector="DataGridCell">
                                <Setter Property="Foreground" Value="White"/>
                            </Style>
                            <Style Selector="DataGridColumnHeader">
                                <Setter Property="Foreground" Value="#888"/>
                                <Setter Property="Background" Value="#2D2D2D"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Style>
                        </DataGrid.Styles>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="CÓDIGO" 
                                                Binding="{Binding Barcode}" 
                                                Width="120"/>
                            <DataGridTemplateColumn Header="ARTICULO" Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <WrapPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="10,0">
                                            <TextBlock Text="{Binding ProductName}" VerticalAlignment="Center" TextWrapping="Wrap" />
                                            <TextBlock Text="{Binding DiscountDisplayInfo}" FontSize="11" Foreground="#A0A0A0" VerticalAlignment="Center" IsVisible="{Binding HasDiscount}" Margin="5,0,0,0" TextWrapping="Wrap" />
                                        </WrapPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="CANTIDAD" 
                                                Binding="{Binding Quantity}" 
                                                Width="100"/>
                            <DataGridTextColumn Header="PRECIO" 
                                                Binding="{Binding FinalUnitPrice, StringFormat='{}{0:C2}'}" 
                                                Width="120"/>
                            <DataGridTextColumn Header="TOTAL" 
                                                Binding="{Binding LineTotal, StringFormat='{}{0:C2}'}" 
                                                Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </Grid>

            <!-- Panel derecho: Totales y acciones rapidas -->
            <Grid Grid.Column="1" RowDefinitions="Auto,*,Auto">
                
                <!-- Totales -->
                <Border Grid.Row="0" Background="#2D2D2D" Padding="15" CornerRadius="4" Margin="0,0,0,10">
                    <StackPanel Spacing="10">
                        <TextBlock Text="RESUMEN" FontSize="14" Foreground="#888" FontWeight="Bold"/>
                        
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Text="Articulos:" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="{Binding TotalItems}" Foreground="White" FontWeight="Bold"/>
                        </Grid>
                        
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Text="Descuento:" Foreground="#FF9800"/>
                            <TextBlock Grid.Column="1" Text="{Binding TotalDiscountDisplay, StringFormat='-{0:C2}'}" Foreground="#FF9800"/>
                        </Grid>
                        
                        <Separator Background="#444"/>
                        
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Text="TOTAL:" FontSize="20" Foreground="White" FontWeight="Bold"/>
                            <TextBlock Grid.Column="1" 
                                       Text="{Binding FinalTotal, StringFormat='{}{0:C2}'}" 
                                       FontSize="28" 
                                       Foreground="#66BB6A" 
                                       FontWeight="Bold"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Acciones rapidas -->
                <ScrollViewer Grid.Row="1" 
                             VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Disabled">
                    <Border Background="#2D2D2D" Padding="10" CornerRadius="4">
                        <StackPanel Spacing="5">
                            <TextBlock Text="ACCIONES" FontSize="12" Foreground="#888" FontWeight="Bold" Margin="5,0,0,5"/>
                            
                            <!-- The buttons F1, F2, F3, and Delete were moved to the top header -->
                            <!-- The F4/F5 Collection buttons have been visually relocated to the top header COBRANZA layout section. -->
                            <!-- Delete product action -->
                            <Button Classes="danger-button" Command="{Binding ClearCartCommand}" HorizontalAlignment="Stretch" Height="40">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="Shift+F5" FontWeight="Bold"/>
                                    <TextBlock Text="Vaciar Carrito"/>
                                </StackPanel>
                            </Button>
                            
                            <Separator Background="#444" Margin="0,5"/>
                            
                            <Button Classes="action-button" 
                                    x:Name="BtnCustomers"
                                    HorizontalAlignment="Stretch"
                                    Background="#FF9800"
                                    Height="40">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="F8" FontWeight="Bold"/>
                                    <TextBlock Text="Clientes"/>
                                </StackPanel>
                            </Button>
                            
                            <Button Classes="action-button" 
                                    Command="{Binding CreditsLayawaysCommand}" 
                                    HorizontalAlignment="Stretch"
                                    Background="#9C27B0"
                                    Height="40">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="F12" FontWeight="Bold"/>
                                    <TextBlock Text="Créditos/Apartados"/>
                                </StackPanel>
                            </Button>
                            
                            <Separator Background="#444" Margin="0,5"/>
                            
                            <!-- Botones de Descuento -->
                            <Button x:Name="BtnSpecialPrice"
                                    Classes="action-button" 
                                    Command="{Binding ApplySpecialPriceCommand}" 
                                    HorizontalAlignment="Stretch"
                                    Background="#FFC107"
                                    Height="40">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="Ctrl+F2" FontWeight="Bold" Foreground="#333"/>
                                    <TextBlock Text="Precio Especial" Foreground="#333"/>
                                </StackPanel>
                            </Button>
                            
                            <Button x:Name="BtnDealerPrice"
                                    Classes="action-button" 
                                    Command="{Binding ApplyDealerPriceCommand}" 
                                    HorizontalAlignment="Stretch"
                                    Background="#2196F3"
                                    Height="40">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="Ctrl+F3" FontWeight="Bold"/>
                                    <TextBlock Text="Precio Vendedor"/>
                                </StackPanel>
                            </Button>
                            
                            <Button x:Name="BtnGeneralDiscount"
                                    Classes="action-button" 
                                    Command="{Binding ShowGeneralDiscountCommand}" 
                                    HorizontalAlignment="Stretch"
                                    Background="#4CAF50"
                                    Height="40">
                                <StackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBlock Text="Ctrl+F6" FontWeight="Bold"/>
                                    <TextBlock Text="Descuento General"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </ScrollViewer>

                <!-- Boton de pagar -->
                <Button Grid.Row="2" 
                        Classes="success-button" 
                        Command="{Binding PayCommand}"
                        HorizontalAlignment="Stretch"
                        Margin="0,10,0,0">
                    <StackPanel Orientation="Horizontal" Spacing="15">
                        <TextBlock Text="F11" FontWeight="Bold" FontSize="18"/>
                        <TextBlock Text="PAGAR" FontSize="18"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Grid>

                    <!-- Barra de estado -->
                    <Border Grid.Row="1" Background="#2D2D2D" Padding="10">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Text="{Binding StatusMessage}" 
                                       Foreground="#888" 
                                       VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1" 
                                       Text="Usa los botones o atajos de teclado para navegar" 
                                       Foreground="#666" 
                                       FontSize="11"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Border>

                    <!-- Barra inferior -->
                    <Border Grid.Row="2" Background="#1A1A1A" Padding="10">
                        <Grid ColumnDefinitions="*,Auto">
                            <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                                <!-- Botón de ayuda - Leyenda de colores -->
                                <Button x:Name="BtnHelp"
                                        Content="?"
                                        Width="32"
                                        Height="32"
                                        FontSize="18"
                                        FontWeight="Bold"
                                        Background="#444"
                                        Foreground="White"
                                        CornerRadius="16"
                                        VerticalAlignment="Center"
                                        ToolTip.Tip="Leyenda de colores"
                                        Cursor="Hand"/>
                                
                                <TextBlock Text="Casa Ceja - Sistema de Punto de Venta v1.0" 
                                           Foreground="#555" 
                                           FontSize="11"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </SplitView.Content>
        </SplitView>

        <!-- Indicador de procesamiento -->
        <Border Grid.RowSpan="4"
                Background="#80000000"
                IsVisible="{Binding IsProcessing}">
            <Border Background="#2D2D2D" 
                    Padding="30" 
                    CornerRadius="8"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                <StackPanel Spacing="15">
                    <ProgressBar IsIndeterminate="True" Width="200"/>
                    <TextBlock Text="Procesando..." 
                               Foreground="White" 
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
        </Border>
    </Grid>
</Window>